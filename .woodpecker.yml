pipeline:
  build:
    image: eloitor/zig:master
    commands:
      - apk add luajit-dev
      - zig build test
      - zig build -Doptimize=ReleaseFast

  publish:
    image: woodpeckerci/plugin-gitea-release
    when:
      event: tag
      branch: master
    settings:
      base_url: https://mzte.de/git
      api_key:
        from_secret: forgejo_key
      files: zig-out/bin/confgen
